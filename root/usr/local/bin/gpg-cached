#!/bin/bash

keys=(
    enc
    git
    pass
)

for key in ${keys[*]}; do
    keygrip=$(gpg --fingerprint --with-keygrip $key | grep Keygrip | head -n 1 | awk '{print $3}')
    cached=$(gpg-connect-agent "KEYINFO --no-ask $keygrip Err Pmt Des" /bye | xargs | awk '{print $7}')

    if [ $cached = 1 ]; then
        printf "$key "
    fi
done
